{% extends 'base/user_base.html' %}
{% block link %}
{% load static %}

<link rel="apple-touch-icon" sizes="180x180" href="{% static 'asset2/images/icons/apple-touch-icon.png' %}">
<link rel="icon" type="image/png" sizes="32x32" href="{% static 'asset2/images/icons/favicon-32x32.png' %}">
<link rel="icon" type="image/png" sizes="16x16" href="{% static 'asset2/images/icons/favicon-16x16.png' %}">
<link rel="manifest" href="{% static 'asset2/images/icons/site.html' %}">
<link rel="mask-icon" href="{% static 'asset2/images/icons/safari-pinned-tab.svg' %}" color="#666666">
<link rel="shortcut icon" href="{% static 'asset2/images/icons/favicon.ico' %}">
<meta name="apple-mobile-web-app-title" content="Molla">
<meta name="application-name" content="Molla">
<meta name="msapplication-TileColor" content="#cc9966">
<meta name="msapplication-config" content="{% static 'asset2/images/icons/browserconfig.xml' %}">
<meta name="theme-color" content="#ffffff">

<!-- Plugins CSS File -->
<link rel="stylesheet" href="{% static 'asset2/css/bootstrap.min.css' %}">
<!-- Main CSS File -->
<link rel="stylesheet" href="{% static 'asset2/css/style.css' %}">
<link rel="stylesheet" href="{% static 'asset2/css/plugins/owl-carousel/owl.carousel.css' %}">
<link rel="stylesheet" href="{% static 'asset2/css/plugins/magnific-popup/magnific-popup.css' %}">
<link rel="stylesheet" href="{% static 'asset2/css/plugins/nouislider/nouislider.css' %}">

{% endblock %}



{% block content %}
<main class="main">
    <div class="page-content">
        <div class="container">
            <div class="row">
                <div class="col-lg-9">
                    <div class="toolbox">
                        <div class="toolbox-left">
                            <div class="toolbox-info">
                                <form method="GET">
                                    <div class="search-container">
                                        <input type="text" name="search" placeholder="Search...">
                                        <button type="submit">
                                            <i class="fas fa-search" style="color: tan; background-color: yellow;"></i>
                                        </button>
                                    </div>
                                </form>
                            </div><!-- End .toolbox-info -->
                        </div><!-- End .toolbox-left -->


                        <div class="toolbox-left">
                            <div class="toolbox-info">
                                Showing <span>{{ obj|length }} of {{ obj.count }} </span> Products
                            </div><!-- End .toolbox-info -->
                        </div>

                        <div class="toolbox-right">
                            <form method="get" id="sortingAndFilterForm" action="{% url 'products:shop' %}">
                                <div class="toolbox-sort">
                                    <label for="sortby">Sort by:</label>
                                    <div class="select-custom">
                                        <select name="sort_by" id="sortby" class="form-control" onchange="document.getElementById('sortingAndFilterForm').submit()">
                                            <option value="-product__created_at" {% if request.GET.sort_by == "-product__created_at" %}selected{% endif %}>Popularity</option>
                                            <option value="product__price" {% if request.GET.sort_by == "product__price" %}selected{% endif %}>Price: Low to High</option>
                                            <option value="-product__price" {% if request.GET.sort_by == "-product__price" %}selected{% endif %}>Price: High to Low</option>
                                            <option value="product__name" {% if request.GET.sort_by == "product__name" %}selected{% endif %}>Alphabetic: A to Z</option>
                                            <option value="-product__name" {% if request.GET.sort_by == "-product__name" %}selected{% endif %}>Alphabetic: Z to A</option>
                                        </select>
                                    </div>
                                </div><!-- End .toolbox-sort -->

                                
                        </div><!-- End .toolbox-right -->
                    </div><!-- End .toolbox -->

                    <div class="products mb-3">
                        <div class="row justify-content-center">
                            {% if no_product %}
                            <h3>No products to show</h3>
                            {%else%}
                            {% for i in obj %}
                            <div class="col-6 col-md-4 col-lg-4">
                                <div class="product product-7 text-center">
                                    <figure class="product-media">
                                        <a href="{% url 'products:single_product' i.id %}">
                                            <img src="{{i.image.url}}" style="width: 277px; height: 277px;" alt="Product image" class="product-image">
                                        </a>
                                        <div class="product-action-vertical">
                                            <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>add to wishlist</span></a>
                                            <a href="popup/quickView.html" class="btn-product-icon btn-quickview" title="Quick view"><span>Quick view</span></a>
                                            <a href="#" class="btn-product-icon btn-compare" title="Compare"><span>Compare</span></a>
                                        </div><!-- End .product-action-vertical -->
                                        <div class="product-action">
                                            <a href="#" class="btn-product btn-cart"><span>add to cart</span></a>
                                        </div><!-- End .product-action -->
                                    </figure><!-- End .product-media -->
                                    <div class="product-body">
                                        <div class="product-cat">
                                            <a href="#">{{i.product.gender}}</a>
                                        </div><!-- End .product-cat -->
                                        <h3 class="product-title"><a href="{% url 'products:single_product' i.id %}">{{i.product.name}}</a></h3><!-- End .product-title -->
                                        <div class="product-price">
                                            {% if i.product.get_discounted_price != i.product.price %}
                                                <span style="text-decoration: line-through;">${{ i.product.price }}</span>
                                                <span style="color: red;">${{ i.product.get_discounted_price }}</span>
                                            {% else %}
                                                ${{ i.product.price }}
                                            {% endif %}
                                        </div><!-- End .product-price -->
                                    </div><!-- End .product-body -->
                                </div><!-- End .product -->
                            </div><!-- End .col-sm-6 col-lg-4 -->
                            {% endfor %}
                            {%endif%}
                        </div><!-- End .row -->
                    </div><!-- End .products -->

                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <a class="page-link page-link-prev" href="#" aria-label="Previous" tabindex="-1" aria-disabled="true">
                                    <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Prev
                                </a>
                            </li>
                            <li class="page-item active" aria-current="page"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item-total">of 6</li>
                            <li class="page-item">
                                <a class="page-link page-link-next" href="#" aria-label="Next">
                                    Next <span aria-hidden="true"><i class="icon-long-arrow-right"></i></span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div><!-- End .col-lg-9 -->

                <aside class="col-lg-3 order-lg-first">
                    <div class="sidebar sidebar-shop">
                        <div class="widget widget-clean">
                            <label>Filters:</label>
                            <a href="{% url 'products:shop' %}" class="sidebar-filter-clear">Clean All</a>
                        </div><!-- End .widget widget-clean -->

                        <div class="widget widget-collapsible">
                            <h3 class="widget-title">
                                <a data-toggle="collapse" href="#widget-1" role="button" aria-expanded="true" aria-controls="widget-1">
                                    Category
                                </a>
                            </h3><!-- End .widget-title -->

                            <div class="collapse show" id="widget-1">
                                <div class="widget-body">
                                    <div class="filter-items filter-items-count">
                                        {% for category in categories %}
                                        <div class="filter-item">
                                            <div class="custom-control custom-checkbox">
                                                <input class="custom-control-input" type="checkbox" name="category" value="{{ category.id }}" id="category-{{ category.id }}" {% if category.id == category_filter %}checked{% endif %} onchange="document.getElementById('sortingAndFilterForm').submit()">
                                                <label class="custom-control-label" for="category-{{ category.id }}">{{ category.type }}</label>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div><!-- End .filter-items -->
                                </div><!-- End .widget-body -->
                            </div><!-- End .collapse -->
                        </div><!-- End .widget -->

                        <div class="widget widget-collapsible">
                            <h3 class="widget-title">
                                <a data-toggle="collapse" href="#widget-3" role="button" aria-expanded="true" aria-controls="widget-3">
                                    Colour
                                </a>
                            </h3><!-- End .widget-title -->


                            <div class="collapse show" id="widget-3">
                                <div class="widget-body">
                                    <div class="filter-colors">
   
                                        {% for colour in colours %}
                                        <div class="custom-control custom-checkbox">
                                            <input class="custom-control-input" 
                                                   type="checkbox" 
                                                   name="color" 
                                                   value="{{ colour.colour }}" 
                                                   id="color-{{ colour.id }}" 
                                                   {% if color_filter == colour.colour %}checked{% endif %} 
                                                   onchange="document.getElementById('sortingAndFilterForm').submit()">
                                            <label class="custom-control-label" 
                                                   for="color-{{ colour.id }}">
                                                <span class="color-indicator" style="background: {{ colour.color_code }};"></span> {{ colour.colour }}
                                            </label>
                                        </div>
                                        {% endfor %}
                         
                                    </div>
                                </div><!-- End .widget-body -->
                            </div><!-- End .collapse -->
       

                        <div class="widget widget-collapsible">
                            <h3 class="widget-title">
                                <a data-toggle="collapse" href="#widget-4" role="button" aria-expanded="true" aria-controls="widget-4">
                                    Brand
                                </a>
                            </h3><!-- End .widget-title -->

                            <div class="collapse show" id="widget-4">
                                <div class="widget-body">
                                    <div class="filter-items">
                                        <div class="filter-item">
                                            {% for brand in brands %}
                                            <div class="custom-control custom-checkbox">
                                                <input class="custom-control-input" type="checkbox" name="brand" value="{{ brand.id }}" id="brand-{{ brand.id }}" {% if brand.id == brand_filter %}checked{% endif %} onchange="document.getElementById('sortingAndFilterForm').submit()">
                                                <label class="custom-control-label" for="brand-{{ brand.id }}">{{ brand.name }}</label>
                                            </div><!-- End .custom-checkbox -->
                                            {% endfor %}
                                        </div><!-- End .filter-item -->
                                    </div><!-- End .filter-items -->
                                </div><!-- End .widget-body -->
                            </div><!-- End .collapse -->
                        </div><!-- End .widget -->
                    </div><!-- End .sidebar sidebar-shop -->
                </aside><!-- End .col-lg-3 -->
            </div><!-- End .row -->
        </div><!-- End .container -->
    </div><!-- End .page-content -->
</main><!-- End .main -->
</form>



<script>
function applyColorFilter(color) {
    const form = document.getElementById('sortingAndFilterForm');
    const urlParams = new URLSearchParams(window.location.search);
    
    // Set or update the color parameter
    urlParams.set('color', color);
    
    // Update the form action with the new URL parameters
    form.action = `${window.location.pathname}?${urlParams}`;
    
    // Submit the form
    form.submit();
}
</script>



{% endblock %}

{% block scripts %}
<script src="{% static 'assets2/js/jquery.min.js' %}"></script>
<script src="{% static 'assets2/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets2/js/jquery.hoverIntent.min.js' %}"></script>
<script src="{% static 'assets2/js/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'assets2/js/superfish.min.js' %}"></script>
<script src="{% static 'assets2/js/owl.carousel.min.js' %}"></script>
<script src="{% static 'assets2/js/wNumb.js' %}"></script>
<script src="{% static 'assets2/js/bootstrap-input-spinner.js' %}"></script>
<script src="{% static 'assets2/js/jquery.magnific-popup.min.js' %}"></script>
<script src="{% static 'assets2/js/nouislider.min.js' %}"></script>
<!-- Main JS File -->
<script src="{% static 'assets2/js/main.js' %}"></script>

{%endblock%}